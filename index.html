<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humi Food - Sản phẩm gia vị</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-6 text-center">
        <h1 class="text-4xl font-bold text-gray-800 mb-4">Humi Food - Sản phẩm gia vị</h1>
        <p class="text-lg text-gray-600 mb-6">Khám phá những hương vị đặc biệt của chúng tôi!</p>

        <!-- Danh sách sản phẩm -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-white shadow-md rounded-lg p-4">
                <img src="muoi-ot-xanh.jpg" alt="Muối Ớt Xanh" class="w-full rounded-md">
                <h2 class="text-xl font-semibold mt-2">Muối Ớt Xanh</h2>
                <p class="text-gray-600">Hương vị tươi mát, phù hợp với hải sản.</p>
                <p class="text-lg font-bold text-blue-500">100,000 VND</p>
            </div>
            <div class="bg-white shadow-md rounded-lg p-4">
                <img src="sot-thai.jpg" alt="Sốt Thai" class="w-full rounded-md">
                <h2 class="text-xl font-semibold mt-2">Sốt Thai</h2>
                <p class="text-gray-600">Hương vị đậm đà, hoàn hảo cho nướng & luộc.</p>
                <p class="text-lg font-bold text-blue-500">100,000 VND</p>
            </div>
            <div class="bg-white shadow-md rounded-lg p-4">
                <img src="muoi-ot-do.jpg" alt="Muối Ớt Đỏ" class="w-full rounded-md">
                <h2 class="text-xl font-semibold mt-2">Muối Ớt Đỏ</h2>
                <p class="text-gray-600">Cay nồng, lý tưởng cho chiên & xào.</p>
                <p class="text-lg font-bold text-blue-500">100,000 VND</p>
            </div>
        </div>

        <!-- Nút Mua Hàng -->
        <button class="bg-blue-500 text-white px-6 py-3 mt-6 rounded-lg shadow hover:bg-blue-700"
                onclick="openForm()">
            Mua hàng
        </button>
    </div>

    <!-- Form đặt hàng -->
    <div id="formPopup" class="fixed inset-0 bg-gray-900 bg-opacity-50 hidden flex items-center justify-center">
    <div id="formContainer" class="bg-white p-6 rounded-lg shadow-lg w-11/12 md:w-3/5 lg:w-1/3 relative">
        <button class="absolute top-3 right-3 text-gray-600 hover:text-gray-800 text-2xl"
                onclick="closeForm()">&times;</button>
        <h2 class="text-2xl font-semibold mb-4">Đặt hàng</h2>
        <div class="overflow-y-auto max-h-[70vh] p-2">
            <form id="orderForm">
                <input type="text" id="name" placeholder="Họ và tên" required class="w-full p-2 border rounded mb-3">
                <input type="tel" id="phone" placeholder="Số điện thoại" required class="w-full p-2 border rounded mb-3">

                <select id="province" required onchange="updateDistricts()" class="w-full p-2 border rounded mb-3">
                    <option value="">Chọn tỉnh/thành phố</option>
                </select>

                <select id="district" required onchange="updateWards()" class="w-full p-2 border rounded mb-3">
                    <option value="">Chọn quận/huyện</option>
                </select>

                <select id="ward" required class="w-full p-2 border rounded mb-3">
                    <option value="">Chọn phường/xã</option>
                </select>

                <input type="text" id="address" placeholder="Địa chỉ chi tiết" required class="w-full p-2 border rounded mb-3">

                <h3 class="font-semibold text-lg mb-3">Chọn sản phẩm</h3>

                <div class="mb-3">
                    <label class="flex items-center">
                        <input type="checkbox" name="product" value="Muối Ớt Xanh" onchange="toggleQuantity(this)" class="mr-2">
                        Muối Ớt Xanh - 100,000 VND
                    </label>
                    <input type="number" name="quantity" data-product="Muối Ớt Xanh" min="1" class="w-full p-2 border rounded quantity-input">
                </div>

                <div class="mb-3">
                    <label class="flex items-center">
                        <input type="checkbox" name="product" value="Sốt Thai" onchange="toggleQuantity(this)" class="mr-2">
                        Sốt Thai - 100,000 VND
                    </label>
                    <input type="number" name="quantity" data-product="Sốt Thai" min="1" class="w-full p-2 border rounded quantity-input">
                </div>

                <div class="mb-3">
                    <label class="flex items-center">
                        <input type="checkbox" name="product" value="Muối Ớt Đỏ" onchange="toggleQuantity(this)" class="mr-2">
                        Muối Ớt Đỏ - 100,000 VND
                    </label>
                    <input type="number" name="quantity" data-product="Muối Ớt Đỏ" min="1" class="w-full p-2 border rounded quantity-input">
                </div>

                <div class="mb-3">
                    <label class="flex items-center">
                        <input type="checkbox" name="product" value="Combo 3 vị" onchange="toggleQuantity(this)" class="mr-2">
                        Combo 3 vị - 200,000 VND
                    </label>
                    <input type="number" name="quantity" data-product="Combo 3 vị" min="1" class="w-full p-2 border rounded quantity-input">
                </div>

                <p class="text-lg font-bold mt-4">Tổng tiền: <span id="totalAmount" class="text-red-500">0</span> VND</p>

                <div class="flex justify-between mt-4">
                    <button type="button" class="bg-gray-400 text-white w-1/2 py-2 rounded-lg shadow mr-2"
                            onclick="closeForm()">
                        Đóng
                    </button>
                    <button type="submit" class="bg-blue-500 text-white w-1/2 py-2 rounded-lg shadow">
                        Gửi đơn hàng
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>


    <script>
        function openForm() {
            document.getElementById("formPopup").classList.remove("hidden");
        }

        function closeForm() {
            document.getElementById("formPopup").classList.add("hidden");
        }

        function toggleQuantity(checkbox) {
            let quantityInput = checkbox.closest("div").querySelector("input[type='number']");
            if (checkbox.checked) {
                quantityInput.value = 1;
            } else {
                quantityInput.value = "";
            }
        }

        async function fetchProvinces() {
        const response = await fetch("https://provinces.open-api.vn/api/p/");
        const provinces = await response.json();
        const provinceSelect = document.getElementById("province");

        provinces.forEach(province => {
            let option = document.createElement("option");
            option.value = province.code;
            option.textContent = province.name;
            provinceSelect.appendChild(option);
        });
    }

    async function updateDistricts() {
        const provinceCode = document.getElementById("province").value;
        const districtSelect = document.getElementById("district");
        const wardSelect = document.getElementById("ward");

        districtSelect.innerHTML = '<option value="">Chọn quận/huyện</option>';
        wardSelect.innerHTML = '<option value="">Chọn phường/xã</option>';

        if (!provinceCode) return;

        const response = await fetch(`https://provinces.open-api.vn/api/p/${provinceCode}?depth=2`);
        const data = await response.json();

        data.districts.forEach(district => {
            let option = document.createElement("option");
            option.value = district.code;
            option.textContent = district.name;
            districtSelect.appendChild(option);
        });
    }

    async function updateWards() {
        const districtCode = document.getElementById("district").value;
        const wardSelect = document.getElementById("ward");

        wardSelect.innerHTML = '<option value="">Chọn phường/xã</option>';

        if (!districtCode) return;

        const response = await fetch(`https://provinces.open-api.vn/api/d/${districtCode}?depth=2`);
        const data = await response.json();

        data.wards.forEach(ward => {
            let option = document.createElement("option");
            option.value = ward.code;
            option.textContent = ward.name;
            wardSelect.appendChild(option);
        });
    }

    fetchProvinces();
document.getElementById("orderForm").addEventListener("submit", async function(event) {
    event.preventDefault();

    let formData = new FormData();
    
    formData.append("entry.448204511", document.getElementById("name").value); // Họ và tên
    
formData.append("entry.542153143", document.getElementById("phone").value); // Số điện thoại
    
formData.append("entry.884701166", document.getElementById("province").options[document.getElementById("province").selectedIndex].text); // Tỉnh
    
formData.append("entry.1736929701", document.getElementById("district").options[document.getElementById("district").selectedIndex].text); // Huyện
    
formData.append("entry.770164974", document.getElementById("ward").options[document.getElementById("ward").selectedIndex].text); // Xã
    
formData.append("entry.839831794", document.getElementById("address").value); // Địa chỉ

    let selectedProducts = [];
    let total = 0;

    document.querySelectorAll("input[name='product']:checked").forEach((product) => {
        let quantity = document.querySelector(`input[data-product="${product.value}"]`).value;
        if (quantity > 0) {
            selectedProducts.push(`${product.value} (x${quantity})`);
            total += quantity * (product.value === "Combo 3 vị" ? 200000 : 100000);
        }
    });

    formData.append("entry.194147620", selectedProducts.join(", ")); // Danh sách sản phẩm
    formData.append("entry.1424511162", total.toString()); // Tổng tiền

    let googleFormURL = "https://docs.google.com/forms/d/e/1FAIpQLSdJ98wULS1awzEz2kMojibPSgNQyDxaGsnnQNoy047naBxbYA/formResponse";

    let response = await fetch(googleFormURL, {
        method: "POST",
        body: formData,
        mode: "no-cors"
    });

    alert("Đặt hàng thành công!");
    closeForm();
});
function toggleQuantity(checkbox) {
    let quantityInput = checkbox.closest("div").querySelector("input[type='number']");
    if (checkbox.checked) {
        quantityInput.value = 1;
    } else {
        quantityInput.value = "";
    }
    calculateTotal();
}

document.querySelectorAll("input[name='quantity']").forEach(input => {
    input.addEventListener("input", calculateTotal);
});

function calculateTotal() {
    let total = 0;
    document.querySelectorAll("input[name='product']:checked").forEach((product) => {
        let quantityInput = document.querySelector(`input[data-product="${product.value}"]`);
        let quantity = parseInt(quantityInput.value) || 0;
        let price = product.value === "Combo 3 vị" ? 200000 : 100000;
        total += quantity * price;
    });

    document.getElementById("totalAmount").textContent = total.toLocaleString();
}

    </script>
</body>
</html>
